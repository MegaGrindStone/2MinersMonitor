name: Push

on: 
  push:
    branches:
      - main

jobs:
  build:
    uses: VeryGoodOpenSource/very_good_workflows/.github/workflows/flutter_package.yml@v1
    with:
      flutter_channel: stable
      min_coverage: 20

  codecov:
    needs: build

    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: ðŸ“Š Check Code Coverage
        uses: VeryGoodOpenSource/very_good_coverage@v1
        with:
          path: ./coverage/lcov.info
      - name: Upload to Codecov
        uses: codecov/codecov-action@v2
        with:
          files: ./coverage/lcov.info